# Full Modern Enterprise Stack

This is a full stack development skeleton to build modern professional enterprise applications. In this state all configurations are for develop mode (local).
**Don't use that configurations on production mode!**

## Getting Started

These instructions will get you a copy of the project (clone repository) up and running on your local machine for development and testing purposes.


**Step 1:** Install OpenJDK on your System, if not exists

**Step 2:** Start Docker Environment

Hint: Database and Axon has to be available for the next step (no 3)
```
docker compose up -d
```

**Step 3:** Install and Build Application
```
./mvnw package
```

#### What's happened here?

* Installing node and npm
* Executing npm install
* Executing npm run build
* Installing all maven dependencies
* Creating two database schemas (avondock,system)
* Seeding Database
* Running Test environment
* Building snapshot jar files for admin,api and frontend
* Creating docker api image

**Step 3.1:** Start the whole enterprise stack
```
./mvnw spring-boot:start
```

**Step 4,5,6** is not necessary anymore, but keep attention, this is not for development -> no hot reloading will work.
For **development stack** you have to execute Step 4,5 and 6

**Step 4:** Start Admin Server (has to run firstly, otherwise your application client could not connect to)

Don't be irritated if you get error messages from the client (api), the Admin Server check the health of your 
complete api and how you have that configured. For example, if you don't have changed anything the Mail Test will failed,
because you have to set the smtp host, username and password in the application.properties by your self

Terminal 1:
This will start the admin server in background!
```
./mvnw spring-boot:start
```

**Step 5:** Start Backend API with hot reloading

Terminal 2:
```
cd api && ./mvnw spring-boot:run
```

**Step 6:** Start Frontend

Terminal 3:
```
cd frontend && npm run serve
```

ATTENTION: hot reloading will so not work, if you want hot reloading, you have to start the apps separately ->

Example website: (rest of available commands you will find in the package.json)
```
cd frontend && npm run start:website
```

## Enterprise Stack

What the hell goes on here :-)

* Auditing any changes (envers)
* Event Sourcing of your aggregates (does we need auditing anymore?) - (Axon)
* Frontend Domain Driven Boundaries (encapsulate with shell pattern) - (nx)
* JWT Token authorization, with an iam database structure
* Switching relation databases to no-sql without change any code
* Running Background Job Daemon (non blocking stuff)
* Email with Template (Freemarker) Service
* Frontend core examples for decorators (like @Route())
* Seeding environment (ex.)
* Testing environment (ex. api and frontend)
* Documentation generated by swagger (fully ui testable)
* Support complete XLIFF translation

**Remember** it's only a skeleton!!!

### Tipps and Tricks

* Don't use Mapping files for your models, first of all spring boot, will per default not read such files and it's in java not recommended, because of the jpa and its abstraction. If you want somehow else a persistence mapping file, you have to override this behaviour by your self...or you can also switch to php :-) 

## How to use

#### Frontend Dev
* Website App: http://localhost:4200
* Admin App: http://localhost:4201
* Mobile App: http://localhost:4202

#### Backend
* API Server: http://localhost:8098
* Rest Docs: http://localhost:8098/swagger-ui/#/
* Axon Dashboard: http://localhost:8024
* Jobrunr Dashboard: http://localhost:8000/dashboard
* Admin Spring Boot Server: http://localhost:8080


## Trouble Shooting

If one of the steps in .mvnw package failed, you can execute this steps separately

### Install Api dependencies
```
./mvnw install
```

### Create Api Docker image
```
cd api && ./mvnw compile jib:dockerBuild
```

### Install Frontend
```
cd frontend && npm i
```

### Install Admin Server
```
cd admin && ./mvnw install
```

## How to do's

#### Activate Cassandra

Comment out the configuration annotation of both persistence configs and uncomment
the configuration annotation of the cassandra config and restart the application

**ATTENTION:** The search criteria actually not supported by OGM, so if you switch to cassandra
you have to deactivate the SeedEventListener and you cannot use the ex. findByCarParkId in the
repository interface. The hibernate developers are currently developing hibernate 6.0, after
release, they want to continue with the OGM

## Deployment

Add additional notes about how to deploy this on a production system.

## Resources

Add links to external resources for this project, such as CI server, bug tracker, etc.

## What's missing

* Architecture Design Overview (specially communication between front -and backend)
* Example to avoid several requests (Use the rxjs technology)
* Extend Frontend Boundaries (access behaviour)
* Transfer website and mobile apps complete to the shell pattern (like administration app)
* Generate your bounded context for backend and api, with an electron app per click and generate (commercial use only)

## Thanks to

* **Spring Boot Framework** ...completely unreachable
* **Axon Framework** ...nice work, the best cqrs framework and interpretation of CQRS analogous to M.Fowler
* **Angular** ...SOLID, you will make enterprise, you don't have a alternative
* **Nrwl** ...thumb up
* **Hibernate** ...no words, awesome...with the ogm this orm play in another level
* **Cypress** ...I have tried, you have done
* **Java Community** ... all the JSRs, to create a programming language, that's for business development unreachable
* **All other (springfox, swagger, lombok, jetbrains (kotlin)...)** ...and those who have published tutorials like (Baeldung) and share their knowledge

...Thank you very much!
